<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="IUDX | Indian Urban Data Exchange">
  <meta name="organization" content="RBCCPS, IISc Bangalore">
  <meta name="keywords" content="IUDX, CATALOGUE, RBCCPS, IISc BANGALORE">
  <meta name="author" content="Jishnu Jaykumar P (http://jishnujayakumar.github.io), Rohina Naaz, Harshubh Meherishi">
  <link rel="shortcut icon" href="../assets/img/custom_iudx.ico">
  <title id="smartcity_name"> </title>
  <link href="../assets/css/swagger/swagger-ui.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script type="text/javascript" src="../assets/conf.js"></script>
  <!-- <link href="../assets/css/mdb.min.css" rel="stylesheet"> -->
  <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.min.css">
  <link href="../assets/css/prettify.css" type="text/css" rel="stylesheet" />
  <link href="../assets/css/list_style.css" rel="stylesheet">
  <link rel="stylesheet" href="../assets/css/jquery-ui.css">
  <link rel="stylesheet" type="text/css" href="../assets/css/alertify.css">
  <link rel="stylesheet" type="text/css" href="../assets/css/common_styles.css">
  <link rel="stylesheet" type="text/css" href="../../assets/css/jqcloud.css">
  <!-- Google Fonts  -->
  <link href="https://fonts.googleapis.com/css?family=Darker+Grotesque&display=swap" rel="stylesheet">
</head>
<body>
    <!-- <div class="container-fluid"> -->
        <!-- ***** Header Area Start ***** -->
        <header>
            <div class="container">
                <div class="row justify-content-around">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-6 align-self-center">
                        <a href="/">
                            <img id="smart_iudx_city_logo" src="../../assets/img/iudx_pscdcl.png" class="img-fluid">
                        </a>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-6 text-right align-self-center">
                        <img src="../assets/img/sc_iisc.png" class="img-fluid">
                    </div>
                </div>
            </div>
        </header>
    <!-- ***** Header Area End ***** -->

    <hr>
    <div class="se-pre-con"></div>

        <section id="landing_section" class="container section">
        <div class="row style_list">
          <div class="col-lg-12">
              <h1 class="heading">
                Discover <span id="resource_item_count"></span> resource-items by <span id="provider_count"></span> provider(s)
              </h1>
          
            <br>

             <p class="lead text-muted">
                   Welcome to the IUDX compliant Catalogue of <a id="smart_city_link" href="#" target="_blank">PSCDCL</a>
	     </p>

            <!-- <br> -->

            <div class="row" id="word">
                <div id="wordCloud" style="width: 550px; height: 350px; margin-left: 280px;"></div>
              </div>

          <!-- <p>
            <a href="#" class="btn btn-primary my-2">Main call to action</a>
            <a href="#" class="btn btn-secondary my-2">Secondary action</a>
          </p> -->
          <div class="row">
              <div class="col-lg-3">
                <!-- <label for="attribute">Attributes</label> -->
                <select class="custom-select d-block w-100" id="attribute" required="">
                  <!-- <option value="">Choose Attribute</option> -->
                  <option value="tags">Tag</option>
                  <option value="resourceServerGroup">Type</option>
                  <option value="provider">Publisher</option>
                  <!-- <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option> -->
                </select>
                <!-- <div class="invalid-feedback">
                  Please select a valid country.
                </div> -->
              </div>
          
          
              <div class="col-lg-7">
                <!-- <label for="value">Value</label> -->
                <input type="text" class="form-control" id="value" placeholder="" required autofocus>
                <!-- <div class="invalid-feedback">
                  Zip code required.
                </div> -->
              </div>
            
            
              <div class="col-lg-2">
                <!-- <label for="state">State</label> -->
                
                <button id="submit_btn" class="btn btn-primary btn-block" type="submit" onclick="get_items($('#attribute :selected').val(),$('#value').val())">Search</button>
                
                <!-- <button class="btn btn-primary btn-block" type="submit" onclick="display_search_section($('#attribute :selected').text(),$('#value').val())">Search</button> -->
                
                <!-- <div class="invalid-feedback">
                  Please provide a valid state.
                </div> -->

              </div>

          </div>
     
            <br>
            <br>
           
          <div class="row">
            <div class="col">
                  <p class="lead text-muted">
                  <span id="api-hits"></span><br>
                  <span id="geo-query-link">
                    <!-- Also checkout the <a href="/c/map" target="_self">Geo Query</a> and <a href="/status" target="_self">Status</a> Interface<br> -->
                  </span> 
                  <!-- API Documentation can be found <a href="https://apidocs.iudx.org.in" target="_blank">here</a><br> -->
                  <a href="../../assets/resources/IUDX-UserManual-v1.0.pdf" target="_blank">Getting Started</a> |
                  <a href="https://apidocs.iudx.org.in" target="_blank">API Docs</a> |
                  <a href="https://github.com/iudx/pyIUDX" target="_blank">Python SDK</a> | 
                  <a href="https://colab.research.google.com/github/iudx/pyIUDX/blob/master/examples/pyIUDX_sample_usecases.ipynb" target="_blank">Jupyter Notebook</a> |
                  <a href="https://www.iudx.org.in/overview-of-iudx/" target="_blank">Overview Of IUDX</a>
                </p>
            </div>
           
        </div>
          <!-- <footer class="text-muted landing_footer"> -->
          <!-- <div id="landing_footer" class="container landing_footer"> -->
          <div id="normal_footer" class="container normal_footer">
          </div>
    <!-- </footer> -->
        </section>


        <section id="search_section" class="container section">
              <div class="row">
              <div class="col-lg-3">
                <!-- <label for="attribute">Attributes</label> -->
                <select class="custom-select d-block w-100" id="_attribute" required="">
                  <!-- <option value="">Choose Attribute</option> -->
                  <option value="tags">Tag</option>
                  <option value="resourceServerGroup">Type</option>
                  <option value="provider">Publisher</option>
                  <!-- <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option>
                  <option>Some attribute</option> -->
                </select>
                <!-- <div class="invalid-feedback">
                  Please select a valid country.
                </div> -->
              </div>
          
              <div class="col-lg-7">
                <!-- <label for="value">Value</label> -->
                <input type="text" class="form-control" id="_value" placeholder="" required autofocus>
                <!-- <div class="invalid-feedback">
                  Zip code required.
                </div> -->
              </div>
            
            
              <div class="col-lg-2">
                <!-- <label for="state">State</label> -->
                <button class="btn btn-primary btn-block" type="submit" onclick="get_items($('#_attribute :selected').val(),$('#_value').val())">Search</button>
                <!-- <div class="invalid-feedback">
                  Please provide a valid state.
                </div> -->
              </div>
            
        
            </div>

            
            <div class="row">
              <div id="retrieved_items_count" class="col card-margin-top"></div>
         <!--      <div class = "col-lg-4 col-md-4">
                <button id="btn-back" class="btn btn-primary" onclick="location.href='/'">Go Back</button>
              </div> -->
            </div>
             
            <div id="searched_items" class="row"></div>


             <!-- Pagination Start-->
             <div id="page-selection" class=" pagination centerFlex" style="padding-top: 40px"><!-- Pagination goes here --></div>
             <!-- Pagination End-->
            
            <!-- <p>search_section</p> -->

            <div id="normal_footer" class="normal_footer">
            </div>

        </section>

        <section id="swagger_section" class="container section">
                      
            <!-- <p>Display OPENAPI JSON as HTML</p> -->
            <button class="btn btn-primary btn-block" onclick="display_saved_search_section()">Go Back</button> <br>
            <div id="swagger_ui"></div>
            
            <div id="normal_footer" class="normal_footer">
            </div>

        </section>

    <!-- </div> -->
</body>
<script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript" src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/jquery-ui.js"></script>
<script type="text/javascript" src="../assets/js/swagger/swagger-ui-bundle.js"></script>
<script type="text/javascript" src="../assets/js/swagger/swagger-ui-standalone-preset.js"></script>
<script type="text/javascript" src="../assets/js/swagger_script.js"></script>
<!-- https://botmonster.com/jquery-bootpag/ -->
<script type="text/javascript" src="../assets/js/jquery.bootpag.min.js"></script> 

<script type="text/javascript" src="../assets/js/alertify.js"></script>
<script type="text/javascript" src="../assets/js/jquery.toast.js"></script>
<script type="text/javascript" src="../assets/js/Chart.min.js"></script>
<script type="text/javascript" src="../assets/js/_chart_functions.js"></script>
<script type="text/javascript" src="../assets/js/common_functions.js"></script>
<script type="text/javascript" src="../assets/js/list_script.js"></script>
<!-- JQcloud -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqcloud/1.0.4/jqcloud.js"></script>

<script>

  // Set up Footer, filter seen_tags_set
$(document).ready(function(){
  
  $("body").fadeIn(1000);
  $("#landing_section").fadeIn();
  
  // wordcloud starts here
  var tag_cloud = [
    {text:"other_ids",weight:6
    // handlers: {
    // click: function() {
    //   get_items('tags',tag_cloud[0].text);
    // }
    // }
  },
    {text:"mers",weight:1},
    {text:"disease",weight:1},
    {text:"ref_spans",weight:6},
    {text:"cite_spanse",weight:6},
    {text:"respiratory",weight:1},
    {text:"last",weight:6},
    {text:"abstract",weight:6},
    {text:"start",weight:6},
    {text:"end",weight:6},
    {text:"ref_id",weight:6},
    {text:"eq_spans",weight:6},
    {text:"ref_entries",weight:6},
    {text:"middle",weight:6},
    {text:"text",weight:6},
    {text:"corona",weight:1},
    {text:"pages",weight:6},
    {text:"back_matter",weight:6},
    {text:"section",weight:6},
    {text:"metadata",weight:6},
    {text:"first",weight:6},
    {text:"title",weight:6},
    {text:"authors",weight:6},
    {text:"virus",weight:1},
    {text:"venue",weight:6},
    {text:"bib_entries",weight:6},
    {text:"covid-19",weight:6},
    {text:"paper_id",weight:6},
    {text:"issn",weight:6},
    {text:"doi",weight:6},
    {text:"sars",weight:1},
    {text:"year",weight:6},
    {text:"email",weight:6},
    {text:"affiliation",weight:6},
    {text:"suffix",weight:6},
    {text:"acute respiratory syndrome",weight:1},
    {text:"body_text",weight:6},
    {text:"volume",weight:6}
];

  var tag_list = new Array();
  for ( var i = 0; i < tag_cloud.length; ++i ) 
  {
    // console.log("hello tag")
    
      var x = tag_cloud[i];
      //  console.log(x)
      tag_list.push({
            text: x.text,
            weight: x.weight,
            handlers : {click: function(e) { 
              console.log(e)
              get_items('tags',e.toElement.innerText); }},
              html: {"class":"zoom"}
      });
      //  console.log(tag_list)
  }
// var stuff = [ {NAME:"n1",COUNT:23,HIDDEN:"1abc"},
//              {NAME:"n2",COUNT:12,HIDDEN:"2abc"},
//              {NAME:"n3",COUNT:22,HIDDEN:"3abc"},
//              {NAME:"n4",COUNT:2,HIDDEN:"4abc"} ];
// var tag_list = new Array();
// for ( var i = 0; i < stuff.length; ++i ) {
// 		var x = stuff[i];
// 		tag_list.push({
// 				text: x.NAME,
// 				weight: x.COUNT,
//             handlers : {click: function() { alert("it worked for" + x.NAME); }},
// 				html: {title: x.COUNT + " varieties"}
// 		});
// }

// $("#example").children("#wordcloud").jQCloud( tag_list );

if(instance_id == "covid-19.iudx.org.in"){
  
$(function() {
        $("#wordCloud").jQCloud(tag_list, 
        {
          // shape: "rectangular",
          autoResize: true
        });
      });
    }
    else {
      $("#wordCloud").addClass("hide-left-nav");
    }
  $.get(cat_conf['cat_base_URL']+"/count", function(data) {
    console.log("Count")
    $("#resource_item_count").html((JSON.parse(data))["Count"]);
  });
  
  $.get(get_internal_apis_endpoint()+"/internal_apis/list/tags", function(data) {
    tags_set=JSON.parse(data)
    // ------------Set the placeholder value to the first value from array response for tags------------
     $('#value').attr("placeholder", "example: "+tags_set[1] + ", " +tags_set[5] + ", " + "or "+tags_set[10]).val("").focus().blur();
      $('#_value').attr("placeholder", "example: "+tags_set[1] + ", " +tags_set[5] + ", " + "or "+tags_set[10]).val("").focus().blur();
    //==========  Capture select for populating autosuggest with tags attribute values 
     if($( "#attribute" ).val() == "tags"){
      // console.log("RRRRRRRRRRRRR1")
      set_attr_value($( "#attribute" ).val(), tags_set)
    }
      if($( "#_attribute" ).val() == "tags"){
        // console.log("RRRRRRRRRRRRR")
        console.log($( "#_attribute" ).val())
      set_attr_value($( "#_attribute" ).val(), tags_set)
      }
    
  });
  
  $.get(get_internal_apis_endpoint()+"/internal_apis/list/resourceServerGroup", function(data) {
    rsg_set=JSON.parse(data)
    console.log(rsg_set)
    for (var i = rsg_set.length - 1; i >= 0; i--) {
       rsg_set[i]=rsg_set[i].split(cat_conf['resource_server_group_head'])[1]
    }
  });
  
  $.get(get_internal_apis_endpoint()+"/internal_apis/list/provider", function(data) {
     console.log(data)
    provider_set=JSON.parse(data)
    console.log(provider_set)
    $("#provider_count").html(provider_set.length);
    for (var i = provider_set.length - 1; i >= 0; i--) {
      console.log(cat_conf['provider_head'])
      provider_set[i]=provider_set[i].split(cat_conf['provider_head'])[1]
      
    }
  });

  call_metrics_api(cat_conf["resoure_server_base_URL"] + "/metrics")
      .then(data => {
          //data = JSON.parse(data)
          $("#api-hits").html("Total API hits: " + data["count"])
        })
      .catch(error => {
          console.log(error)
  })

  $("#landing_footer, #normal_footer").html(getFooterContent());

  if(legends !== "#"){
    $("#geo-query-link").html("Also checkout the <a href='/c/map' target='_self'>Geo Query</a> and <a href='/status' target='_self'>Status</a> Interface<br>")
  }
  

});





// Capture select on change effect for populating autosuggest with attribute values 
$('#attribute').on('change', function() {
  var _arr = []
  if(this.value == "tags"){
    $('#value').attr("placeholder", "example: "+tags_set[1] + ", " +tags_set[5] + ", " + "or "+tags_set[10]).val("").focus().blur();
    // $('#_value').attr("placeholder", "example: "+tags_set[1] + ", " +tags_set[5] + ", " + "or "+tags_set[10]).val("").focus().blur();
    _arr = tags_set
  }else if(this.value == "resourceServerGroup"){
    $('#value').attr("placeholder", "example: "+rsg_set[0]).val("").focus().blur();
    // $('#_value').attr("placeholder", "example: "+rsg_set[0]).val("").focus().blur();
    _arr = rsg_set
  }else if(this.value == "provider"){
    $('#value').attr("placeholder", "example: "+provider_set[0]).val("").focus().blur();
    // $('#_value').attr("placeholder", "example: "+provider_set[0]).val("").focus().blur();
    _arr = provider_set
  }
  set_attr_value(this.value, _arr)
});

$('#_attribute').on('change', function() {
  var _arr = []
  if(this.value == "tags"){
    $('#_value').attr("placeholder", "example: "+tags_set[1] + ", " +tags_set[5] + ", " + "or "+tags_set[10]).val("").focus().blur();
    // $('#_value').attr("placeholder", "example: "+tags_set[1] + ", " +tags_set[5] + ", " + "or "+tags_set[10]).val("").focus().blur();
    _arr = tags_set
  }else if(this.value == "resourceServerGroup"){
    $('#_value').attr("placeholder", "example: "+rsg_set[0]).val("").focus().blur();
    // $('#_value').attr("placeholder", "example: "+rsg_set[0]).val("").focus().blur();
    _arr = rsg_set
  }else if(this.value == "provider"){
    $('#_value').attr("placeholder", "example: "+provider_set[0]).val("").focus().blur();
    // $('#_value').attr("placeholder", "example: "+provider_set[0]).val("").focus().blur();
    _arr = provider_set
    console.log(_arr)
  }
  set_attr_value(this.value, _arr)
});
//Added for enter from the keyboard for attribute value
$("#value").on('keyup', function (e) {
    if (e.keyCode === 13) {
      get_items($('#attribute :selected').val(),$('#value').val())
    }
});

$("#_value").on('keyup', function (e) {
    if (e.keyCode === 13) {
      get_items($('#_attribute :selected').val(),$('#_value').val())
    }
});

// Capture search input click
$(".ui-menu").on('click',function(){
  ////console.log("s",this.value)
});


 $(window).load(function() {
     // Animate loader off screen
     $(".se-pre-con").fadeOut("slow");

  //Added for autofocus
  $( "#value" ).focus();
 
  // if(location.href == location.origin + "\c")
  // {
  //   $( "#value" ).focus();
  // $('#_value').focus();
  // } 
   });
</script>
</html>
